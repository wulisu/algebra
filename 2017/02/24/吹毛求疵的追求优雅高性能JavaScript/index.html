<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>吹毛求疵的追求优雅高性能JavaScript | 前端小密圈</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="李小龙说过:&quot;天下武功,无坚不摧,唯快不破&quot;.(真的说过吗?);我想说的是:&quot;世间网站,完美体验,唯快不破&quot;.(这个我承认我说过.)">
<meta name="keywords" content="JavaScript,性能">
<meta property="og:type" content="article">
<meta property="og:title" content="吹毛求疵的追求优雅高性能JavaScript">
<meta property="og:url" content="http://qdxmq.com/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/index.html">
<meta property="og:site_name" content="前端小密圈">
<meta property="og:description" content="李小龙说过:&quot;天下武功,无坚不摧,唯快不破&quot;.(真的说过吗?);我想说的是:&quot;世间网站,完美体验,唯快不破&quot;.(这个我承认我说过.)">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/a660cab2gy1fczod9ruvrj20f608f441">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/a660cab2gy1fczp9j2snuj2068068t8w">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/a660cab2gy1fczoxy0ftyj20b4093glt">
<meta property="og:image" content="http://ww1.sinaimg.cn/mw690/a660cab2gy1fd0afe4m1fj20t20podjs">
<meta property="og:image" content="http://ww1.sinaimg.cn/mw690/a660cab2gy1fd0aj32vg1j20yo11cae9">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/a660cab2gy1fd0v4rfhz8j20g409baaf">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/a660cab2gy1fd0v20nqxyj206a06oaa0">
<meta property="og:updated_time" content="2017-04-30T08:49:40.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="吹毛求疵的追求优雅高性能JavaScript">
<meta name="twitter:description" content="李小龙说过:&quot;天下武功,无坚不摧,唯快不破&quot;.(真的说过吗?);我想说的是:&quot;世间网站,完美体验,唯快不破&quot;.(这个我承认我说过.)">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/a660cab2gy1fczod9ruvrj20f608f441">
  
    <link rel="alternative" href="/atom.xml" title="前端小密圈" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  

  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>

<a href="https://github.com/jawil"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png"></a>

<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpeg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="搜索微信公众号:前端小密圈">前端小密圈</a></h1>
        </hgroup>

        
        <p class="header-subtitle">若批评无自由，则赞美无意义。</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>

                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/archives">所有文章</a></li>
                        
                            <li><a href="/thoughts">随笔</a></li>
                        
                            <li><a href="/works">作品展示</a></li>
                        
                            <li><a href="/FrontEndGuide">前端导航</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="mailto:jawil1024@gmail.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/jawil" title="github">github</a>
                            
                                <a class="fl segmentfault" target="_blank" href="https://segmentfault.com/u/jawil" title="segmentfault">segmentfault</a>
                            
                                <a class="fl JueJin" target="_blank" href="https://juejin.im/user/573b702c71cfe4006c1201f0/share" title="JueJin">JueJin</a>
                            
                        </ul>
                    </nav>
                </section>

                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/ECMAScript规范/" style="font-size: 15px;">ECMAScript规范</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/Plugins/" style="font-size: 10px;">Plugins</a> <a href="/tags/UI设计/" style="font-size: 10px;">UI设计</a> <a href="/tags/first-article/" style="font-size: 10px;">first-article</a> <a href="/tags/三次握手/" style="font-size: 10px;">三次握手</a> <a href="/tags/小技巧/" style="font-size: 10px;">小技巧</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/性能/" style="font-size: 10px;">性能</a> <a href="/tags/掘金/" style="font-size: 10px;">掘金</a> <a href="/tags/收集/" style="font-size: 10px;">收集</a> <a href="/tags/效率/" style="font-size: 10px;">效率</a> <a href="/tags/玄学/" style="font-size: 15px;">玄学</a> <a href="/tags/记录/" style="font-size: 10px;">记录</a> <a href="/tags/难点/" style="font-size: 10px;">难点</a> <a href="/tags/面试/" style="font-size: 15px;">面试</a>
                    </div>
                </section>
                

                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://github.com/jawil/">github</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://lishuo.me/">特立独行的猪手</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Too young,too simple.Sometimes,naive &amp; stupid.</div>
                </section>
                
            </div>
        </div>

    </header>

    
        <div class="page-reward" style="position:absolute;top:73%;left:50%;margin-left:-30px;">
          <p><a href="javascript:void(0)" onclick="dashangToggleIndex()" class="dashang" title="打赏，支持一下">赏</a></p>
          <div class="hide_box_index"></div>
          <div class="shang_box_index">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggleIndex()" title="关闭" style="position:relative;left:110px;">×</a>
            <div class="shang_tit">
              <p>纯属好玩</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
            </div>
              <div class="pay_explain">扫码打赏，你说多少就多少，买房就差你们打赏之外那部分钱</div>
            <div class="shang_payselect" style="width:100%;text-align:center;line-height:60px;">
              
                <div class="pay_item checked" data-id="alipay" style="display:inline-block;width:40%;float:none;width:130px;">
                  <span class="radiobox" style="display:inline-block;float:none;margin-right:0;"></span>
                  <span class="pay_logo" style="vertical-align:middle"><img src="/img/alipay.png" alt="支付宝" style="height:30px;" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat" style="display:inline-block;float:none;">
                  <span class="radiobox" style="display:inline-block;float:none;margin:0"></span>
                  <span class="pay_logo" style="vertical-align:middle"><img src="/img/weixin.png" alt="微信" style="height:30px;" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"支付宝":"微信");
          });
          function dashangToggleIndex(){
            $(".hide_box_index").fadeToggle();
            $(".shang_box_index").fadeToggle();
          }
        </script>
      


    <div id="music163player">
  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=29816871&auto=0&height=66">
  </iframe>
</div>

</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">前端小密圈</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpeg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">前端小密圈</a></h1>
            </hgroup>
            
            <p class="header-subtitle">若批评无自由，则赞美无意义。</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/archives">所有文章</a></li>
                
                    <li><a href="/thoughts">随笔</a></li>
                
                    <li><a href="/works">作品展示</a></li>
                
                    <li><a href="/FrontEndGuide">前端导航</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="mailto:jawil1024@gmail.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/jawil" title="github">github</a>
                    
                        <a class="segmentfault" target="_blank" href="https://segmentfault.com/u/jawil" title="segmentfault">segmentfault</a>
                    
                        <a class="JueJin" target="_blank" href="https://juejin.im/user/573b702c71cfe4006c1201f0/share" title="JueJin">JueJin</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-吹毛求疵的追求优雅高性能JavaScript" class="article article-type-post" itemscope itemprop="blogPost">

  
    <div class="article-meta">
      <a href="/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/" class="article-date">
      <time datetime="2017-02-24T05:09:42.000Z" itemprop="datePublished">2017-02-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      吹毛求疵的追求优雅高性能JavaScript
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/性能优化/">性能优化</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/性能/">性能</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">

    <div class="tips">
  全文总共<span class="post-count">7,383</span>字，阅读时长预计需要<span class="post-count">28</span>分钟，感谢您的阅读，有错误还望留言批评指正，一起交流学习。
    </div>

      
          
        <h2 id="本文已经首发在掘金专栏-谢谢各位的收藏与支持-掘金专栏地址"><a href="#本文已经首发在掘金专栏-谢谢各位的收藏与支持-掘金专栏地址" class="headerlink" title="本文已经首发在掘金专栏,谢谢各位的收藏与支持,掘金专栏地址~~~"></a>本文已经首发在掘金专栏,谢谢各位的收藏与支持,<a href="https://gold.xitu.io/post/58affa7d128fe1006cb3a2a3" target="_blank" rel="external">掘金专栏地址</a>~~~</h2><p><strong>李小龙说过:”天下武功,无坚不摧,唯快不破”.</strong>(真的说过吗?)<br><strong>我想说的是:”世间网站,完美体验,唯快不破”.</strong>(这个我承认我说过.)</p>
<p><img src="http://ww1.sinaimg.cn/large/a660cab2gy1fczod9ruvrj20f608f441" alt=""></p>
<p>俗话说,时间就是生命,时间就是金钱,时间就是一切,人人都不想把时间白白浪费,一个网站,最重要的就是体验,而网站好不好最直观的感受就是这个网站打开速度快不快,卡不卡.</p>
<p>当打开一个购物网站卡出翔,慢的要死,是不是如同心塞一样的感受,蓝瘦香菇,想买个心爱的宝贝都不能买,心里想这尼玛什么玩意.</p>
<p><img src="http://ww1.sinaimg.cn/large/a660cab2gy1fczp9j2snuj2068068t8w" alt=""></p>
<p>那么如何让我们的网站给用户最佳的体验呢?大环境我们不说,什么网络啊,浏览器性能啊,这些我们无法改变,我们能改变的就是我们码农能创造的,那就是代码的性能.代码精简,执行速度快,嵌套层数少等等都是我们可以着手优化注意的地方.</p>
<p>恰巧最近刚看完<strong>《高性能JavaScript》</strong>收获颇丰,今天就以点带面从追求高性能JavaScript的目的书写的代码来感受一下速度提升带来的体验,从<strong>编程实践，代码优化</strong>的角度总结一下自己平时遇到、书中以及其他地方看到有关提高JavaScript性能的例子,其他关于<strong>加载和执行,数据存取,浏览器中的DOM,算法和流程控制,字符串和正则表达式,快速响应的用户界面,Ajax</strong>这些大范围的方向这里就不多加阐述.<strong>我们从代码本身出发,用数据说话,挖掘那些细思极恐的效率.</strong>有的提升可能微不足道,但是所有的微不足道聚集在一起就是一个从<strong>量到质变</strong>.</p>
<p><img src="http://ww1.sinaimg.cn/large/a660cab2gy1fczoxy0ftyj20b4093glt" alt=""></p>
<p>比较宽泛的阐释高性能JavaScript,从大体上了解提高JavaScript性能的有几个大方面,可以阅读这两篇文章作详细了解:</p>
<blockquote>
<p><a href="https://segmentfault.com/a/1190000008364597" target="_blank" rel="external">高性能JavaScript读书笔记</a>.<br><a href="http://blog.csdn.net/hello_world_20/article/details/46793317" target="_blank" rel="external">高性能javascript小结</a></p>
</blockquote>
<p>本文只从代码和数据上阐述具体说明如何一步步提高JavaScript的性能.</p>
<p><strong>Javascript是一门非常灵活的语言，我们可以随心所欲的书写各种风格的代码，不同风格的代码也必然也会导致执行效率的差异，作用域链、闭包、原型继承、eval等特性，在提供各种神奇功能的同时也带来了各种效率问题，用之不慎就会导致执行效率低下,开发过程中零零散散地接触到许多提高代码性能的方法，整理一下平时比较常见并且容易规避的问题。</strong></p>
<h2 id="算法和流程控制的优化"><a href="#算法和流程控制的优化" class="headerlink" title="算法和流程控制的优化"></a>算法和流程控制的优化</h2><h4 id="循坏"><a href="#循坏" class="headerlink" title="循坏"></a>循坏</h4><p>你一天（一周）内写了多少个循环了？<br>我们先以最简单的循环入手作为切入点,这里我们<strong>只考虑单层循环以及比较不同循环种类和不同流程控制</strong>的效率.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">测试数据:[1,2,3,...,10000000]</div><div class="line">测试依据:数组[1,2,3,&apos;&apos;&apos;,10000000]的累加所需要的时间</div><div class="line">测试环境:node版本v6.9.4环境的v8引擎</div></pre></td></tr></table></figure>
<p><strong>为什么不在浏览器控制台测试?</strong><br>首先不同浏览器的不同版本性能可能就不一样,这里为了统一,我选择了<code>node</code>环境,为什么不选择浏览器而选择了<code>node</code>环境测试,这是因为浏览器的一部分原因.</p>
<p><strong>因为用控制台是测不出性能的，因为控制台本质上是个套了一大堆安全机制的eval，它的沙盒化程度很高。这里我们就一个简单的例子来对比一下,浏览器和node环境同样的代码的执行效率.</strong></p>
<p>测试的数组代码:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> n = <span class="number">10000000</span>;</div><div class="line"><span class="comment">// 准备待测数组</span></div><div class="line"><span class="keyword">var</span> arr = [];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> count=<span class="number">0</span>;count&lt;n;count++)&#123;</div><div class="line">    arr[count] = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// for 测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for'</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</div><div class="line">    arr[i];</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for'</span>);</div></pre></td></tr></table></figure>
<p>就想简单测试一下这段生成待测数组所消耗时间的对比:</p>
<p>这是最新谷歌浏览器控制台的执行结果:</p>
<p><img src="http://ww1.sinaimg.cn/mw690/a660cab2gy1fd0afe4m1fj20t20podjs" alt=""></p>
<p>时间大约在<strong>28ms</strong>左右.</p>
<p>我们再来在<code>node</code>环境下测试一下所需要的时间:</p>
<p><img src="http://ww1.sinaimg.cn/mw690/a660cab2gy1fd0aj32vg1j20yo11cae9" alt=""></p>
<p>时间稳定在<strong>7ms</strong>左右,大约<strong>3倍</strong>的差距,同样都是<code>v8</code>引擎,浏览器就存在很明显的差距,这是由于浏览器的机制有关,浏览器要处理的事情远远比单纯在<code>node</code>环境下执行代码处理的事情多,所以用浏览器测试性能没有在单纯地<code>node</code>环境下靠谱.</p>
<p>具体细节和讨论可以参看知乎上的这篇<strong>RednaxelaFX</strong>的回答:<br><a href="https://www.zhihu.com/question/29352114/answer/44050599" target="_blank" rel="external">为何浏览器控制台的JavaScript引擎性能这么差?</a></p>
<p>各个循环实现的测试代码,每个方法都会单独执行,一起执行会有所偏差.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// for 测试(for和while其实差不多,这里我们只测试for循环)</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for'</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</div><div class="line">    arr[i];</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// for loop测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for'</span>);</div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</div><div class="line">    sum += arr[i];</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// for loop缓存测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for cache'</span>);</div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line"><span class="keyword">var</span> len = arr.length;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">    sum += arr[i];</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for cache'</span>);</div><div class="line"></div><div class="line"><span class="comment">// for loop倒序测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for reverse'</span>);</div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line"><span class="keyword">var</span> len = arr.length;</div><div class="line"><span class="keyword">for</span> (i = len<span class="number">-1</span>;i&gt;<span class="number">0</span>; i--) &#123;</div><div class="line">    sum += arr[i];</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for reverse'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//forEach测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'forEach'</span>);</div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">ele</span>) </span>&#123;</div><div class="line">    sum += ele;</div><div class="line">&#125;)</div><div class="line"><span class="comment">//这段代码看起来更加简洁，但这种方法也有一个小缺陷：你不能使用break语句中断循环，也不能使用return语句返回</span></div><div class="line">到外层函数。</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'forEach'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//ES6的for of测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for of'</span>);</div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</div><div class="line">    sum += i;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for of'</span>);</div><div class="line"><span class="comment">//这是最简洁、最直接的遍历数组元素的语法</span></div><div class="line"><span class="comment">//这个方法避开了for-in循环的所有缺陷</span></div><div class="line"><span class="comment">//与forEach()不同的是，它可以正确响应break、continue和return语句</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// for in 测试</span></div><div class="line"><span class="built_in">console</span>.time(<span class="string">'for in'</span>);</div><div class="line"><span class="keyword">var</span> sum=<span class="number">0</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> arr)&#123;</div><div class="line">    sum+=arr[i];</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'for in'</span>);</div><div class="line">这是最简洁、最直接的遍历数组元素的语法</div><div class="line">这个方法避开了<span class="keyword">for</span>-<span class="keyword">in</span>循环的所有缺陷</div><div class="line">与forEach()不同的是，它可以正确响应<span class="keyword">break</span>、<span class="keyword">continue</span>和<span class="keyword">return</span>语句</div></pre></td></tr></table></figure>
<p>最后在<code>node</code>环境下各自所花费的不同时间:</p>
<table>
<thead>
<tr>
<th>循环类型</th>
<th>耗费时间(ms)</th>
</tr>
</thead>
<tbody>
<tr>
<td>for</td>
<td>约11.998</td>
</tr>
<tr>
<td>for cache</td>
<td>约10.866</td>
</tr>
<tr>
<td>for 倒序</td>
<td>约11.230</td>
</tr>
<tr>
<td>forEach</td>
<td>约400.245</td>
</tr>
<tr>
<td>for in</td>
<td>约2930.118</td>
</tr>
<tr>
<td>for of</td>
<td>约320.921</td>
</tr>
</tbody>
</table>
<p><strong>从上面的表格统计比较可以看出,前三种原始的for循坏一个档次,然后forEach和for of也基本属于一个档次,for of的执行速度稍微高于forEach,最后最慢的就是for in循环了,差的不是几十倍的关系了.</strong></p>
<p>看起来好像是那么回事哦!<br><img src="http://ww1.sinaimg.cn/large/a660cab2gy1fd0v4rfhz8j20g409baaf" alt=""></p>
<p>同样是循坏为什么会有如此大的悬殊呢?我们来稍微分析一下其中的个别缘由导致这样的差异.</p>
<p><strong>for in 一般是用在对象属性名的遍历上的，由于每次迭代操作会同时搜索实例本身的属性以及原型链上的属性，所以效率肯定低下.</strong></p>
<p><code>for...in</code>实际上效率是最低的。这是因为 <code>for...in</code>有一些特殊的要求，具体包括：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1. 遍历所有属性，不仅是 ownproperties 也包括原型链上的所有属性。</div><div class="line">2. 忽略 enumerable 为 false 的属性。</div><div class="line">3. 必须按特定顺序遍历，先遍历所有数字键，然后按照创建属性的顺序遍历剩下的。</div></pre></td></tr></table></figure>
<p><strong>这里既然扯到对象的遍历属性,就顺便扯一扯几种对象遍历属性不同区别,为什么<code>for...in</code>性能这么差,算是一个延伸吧,反正我发现写一篇博客可以延伸很多东西,自己也可以学到很多,还可以巩固自己之前学过但是遗忘的一些东西,算是温故而知新.</strong></p>
<p>遍历数组属性目前我知道的有:<code>for-in</code>循环、<code>Object.keys()</code>和<code>Object.getOwnPropertyNames()</code>,那么三种到底有啥区别呢?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">for-in循环:会遍历对象自身的属性,以及原型属性,包括enumerable 为 false(不可枚举属性);</div><div class="line">Object.keys():可以得到自身可枚举的属性,但得不到原型链上的属性;</div><div class="line">Object.getOwnPropertyNames():可以得到自身所有的属性(包括不可枚举),但得不到原型链上的属性,Symbols属性</div><div class="line">也得不到.</div></pre></td></tr></table></figure>
<p><code>Object.defineProperty</code>顾名思义，就是用来定义对象属性的，<code>vue.js</code>的双向数据绑定主要在<code>getter</code>和<code>setter</code>函数里面插入一些处理方法，当对象被读写的时候处理方法就会被执行了。 关于这些方法和属性的更具体解释，可以看MDN上的解释（<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="external">戳我</a>）；</p>
<p>简单看一个小demo例子加深理解,对于<code>Object.defineProperty</code>属性不太明白,可以看看上面介绍的文档学习补充一下.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="keyword">this</span>.name = <span class="string">'jawil'</span>;</div><div class="line">    &#125;</div><div class="line">    getName() &#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">            <span class="keyword">super</span>();</div><div class="line">            <span class="keyword">this</span>.age = <span class="number">22</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//getAge不可枚举</span></div><div class="line">    getAge() &#123;&#125;</div><div class="line">        [<span class="built_in">Symbol</span>(<span class="string">'fullName'</span>)]() &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">B.prototype.get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> B();</div><div class="line"></div><div class="line"><span class="comment">//设置b对象的info属性的enumerable: false,让其不能枚举.</span></div><div class="line"><span class="built_in">Object</span>.defineProperty(b, <span class="string">'info'</span>, &#123;</div><div class="line">    <span class="attr">value</span>: <span class="number">7</span>,</div><div class="line">    <span class="attr">writable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">enumerable</span>: <span class="literal">false</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//Object可以得到自身可枚举的属性,但得不到原型链上的属性</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(b)); <span class="comment">//[ 'name', 'age' ]</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//Object可A以得到自身所有的属性(包括不可枚举),但得不到原型链上的属性,Symbols属性也得不到</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(b)); <span class="comment">//[ 'name', 'age', 'info' ]</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> b) &#123;</div><div class="line">    <span class="built_in">console</span>.log(attr);<span class="comment">//name,age,get</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//in会遍历对象自身的属性,以及原型属性</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'getName'</span> <span class="keyword">in</span> b); <span class="comment">//true</span></div></pre></td></tr></table></figure>
<p><strong>从这里也可以看出为什么<code>for...in</code>性能这么慢,因为它要遍历自身的属性和原型链上的属性,这无疑就增加了所有不必要的额外开销.</strong></p>
<p><strong>目前绝大部分开源软件都会在for loop中缓存数组长度，因为普通观点认为某些浏览器Array.length每次都会重新计算数组长度，因此通常用临时变量来事先存储数组长度，以此来提高性能.</strong></p>
<p><strong>而forEach是基于函数的迭代（需要特别注意的是所有版本的ie都不支持，如果需要可以用JQuery等库），对每个数组项调用外部方法所带来的开销是速度慢的主要原因.</strong></p>
<p><strong>总结:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">1.能用for缓存的方法循环就用for循坏,性能最高,写起来繁杂;</div><div class="line">2.不追求极致性能的情况下,建议使用forEach方法,干净，简单，易读，短，没有中间变量，没有成堆的分号，简单非常</div><div class="line">优雅;</div><div class="line">3.想尝鲜使用ES6语法的话,不考虑兼容性情况下,推荐使用for of方法,这是最简洁、最直接的遍历数组元素的语法,该方</div><div class="line">法避开了for-in;循环的所有缺陷与forEach()不同的是，它可以正确响应break、continue和return语句.</div><div class="line">4.能避免for in循环尽量避免,太消费性能,太费时间,数组循环不推荐使用.</div></pre></td></tr></table></figure>
<h4 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h4><p>常见的条件语句有<code>if-else</code>和<code>switch-case</code>，那么什么时候用<code>if-else</code>，什么时候用<code>switch-case</code>语句呢？<br>　　<br>我们先来看个简单的<code>if-else</code>语句的代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (value == <span class="number">0</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result0;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result1;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">2</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result2;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">3</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result3;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">4</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result4;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">5</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result5;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">6</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result6;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">7</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result7;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">8</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result8;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">9</span>)&#123;</div><div class="line">    <span class="keyword">return</span> result9;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> result10;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最坏的情况下<code>（value=10）</code>我们可能要做10次判断才能返回正确的结果，那么我们怎么优化这段代码呢？一个显而易见的优化策略是将最可能的取值提前判断，比如<code>value</code>最可能等于5或者10，那么将这两条判断提前。但是通常情况下我们并不知道（最可能的选择），这时我们可以采取二叉树查找策略进行性能优化。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (value &lt; <span class="number">6</span>)&#123;</div><div class="line">    <span class="keyword">if</span> (value &lt; <span class="number">3</span>)&#123;</div><div class="line">        <span class="keyword">if</span> (value == <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result0;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result1;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> result2;</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (value == <span class="number">3</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result3;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">4</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result4;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> result5;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">if</span> (value &lt; <span class="number">8</span>)&#123;</div><div class="line">        <span class="keyword">if</span> (value == <span class="number">6</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result6;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> result7;</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (value == <span class="number">8</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result8;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">9</span>)&#123;</div><div class="line">            <span class="keyword">return</span> result9;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> result10;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样优化后我们最多进行4次判断即可，大大提高了代码的性能。这样的优化思想有点类似二分查找，和二分查找相似的是，只有<code>value</code>值是连续的数字时才能进行这样的优化。但是代码这样写的话不利于维护，如果要增加一个条件，或者多个条件，就要重写很多代码，这时<code>switch-case</code>语句就有了用武之地。</p>
<p>将以上代码用<code>switch-case</code>语句重写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">switch</span>(value)&#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> result0;</div><div class="line">    <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span> result1;</div><div class="line">    <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> result2;</div><div class="line">    <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">        <span class="keyword">return</span> result3;</div><div class="line">    <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">        <span class="keyword">return</span> result4;</div><div class="line">    <span class="keyword">case</span> <span class="number">5</span>:</div><div class="line">        <span class="keyword">return</span> result5;</div><div class="line">    <span class="keyword">case</span> <span class="number">6</span>:</div><div class="line">        <span class="keyword">return</span> result6;</div><div class="line">    <span class="keyword">case</span> <span class="number">7</span>:</div><div class="line">        <span class="keyword">return</span> result7;</div><div class="line">    <span class="keyword">case</span> <span class="number">8</span>:</div><div class="line">        <span class="keyword">return</span> result8;</div><div class="line">    <span class="keyword">case</span> <span class="number">9</span>:</div><div class="line">        <span class="keyword">return</span> result9;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">return</span> result10;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>swtich-case</code>语句让代码显得可读性更强，而且<code>swtich-case</code>语句还有一个好处是如果多个<code>value</code>值返回同一个结果，就不用重写<code>return</code>那部分的代码。一般来说，当<code>case</code>数达到一定数量时，<code>swtich-case</code>语句的效率是比<code>if-else</code>高的，因为<code>switch-case</code>采用了<a href="https://en.wikipedia.org/wiki/Switch_statement" target="_blank" rel="external">branch table（分支表）</a>索引来进行优化，当然各浏览器的优化程度也不一样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">相对来说，下面几种情况更适合使用switch结构：</div><div class="line"></div><div class="line">枚举表达式的值。这种枚举是可以期望的、平行逻辑关系的。</div><div class="line"></div><div class="line">表达式的值具有离散性，不具有线性的非连续的区间值。</div><div class="line"></div><div class="line">表达式的值是固定的，不是动态变化的。</div><div class="line"></div><div class="line">表达式的值是有限的，而不是无限的，一般情况下表达式应该比较少。</div><div class="line"></div><div class="line">表达式的值一般为整数、字符串等类型的数据。</div><div class="line"></div><div class="line">而if结构则更适合下面的一些情况：</div><div class="line"></div><div class="line">具有复杂的逻辑关系。</div><div class="line"></div><div class="line">表达式的值具有线性特征，如对连续的区间值进行判断。</div><div class="line"></div><div class="line">表达式的值是动态的。</div><div class="line"></div><div class="line">测试任意类型的数据。</div></pre></td></tr></table></figure>
<p>除了<code>if-else</code>和<code>swtich-case</code>外，我们还可以采用查找表。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> results = [result0, result1, result2, result3, result4, result5, result6, result7, </div><div class="line">result8, result9, result10];</div><div class="line"></div><div class="line"><span class="comment">//return the correct result</span></div><div class="line"><span class="keyword">return</span> results[value];</div></pre></td></tr></table></figure>
<p>　　当数据量很大的时候，查找表的效率通常要比<code>if-else</code>语句和<code>swtich-case</code>语句高，查找表能用数字和字符串作为索引，而如果是字符串的情况下，最好用对象来代替数组。当然查找表的使用是有局限性的，每个<code>case</code>对应的结果只能是一个取值而不能是一系列的操作。<br>　　<br>　　从根源上分析<code>if else</code> 和 <code>switch</code>的效率,之前只知道<code>if else</code> 和<code>switch</code>算法实现不同,但具体怎么样就不清楚了,为了刨根问底,翻阅了很多资料,但无奈找到了原因我还是不太懂,只知道就是这么回事,不懂汇编,懂底层汇编的大神还望多加指点.<br>　　<br>　　想要深入从汇编的角度了解可以看看这篇文章:<a href="http://www.2cto.com/os/201404/291376.html" target="_blank" rel="external">switch…case和if…else效率比较</a><br>　　<br>　　学前端的我想问你汇编是啥?能吃吗?<br>　　<img src="http://ww1.sinaimg.cn/large/a660cab2gy1fd0v20nqxyj206a06oaa0" alt=""><br>　　　　<br>　　在选择分支较多时，选用<code>switch...case</code>结构会提高程序的效率，但<code>switch</code>不足的地方在于只能处理字符或者数字类型的变量，<code>if...else</code>结构更加灵活一些，<code>if...else</code>结构可以用于判断表达式是否成立，比如<code>if(a+b&gt;c),if...else</code>的应用范围更广，<code>switch...case</code>结构在某些情况下可以替代<code>if...else</code>结构。<br>　　<br><strong>小结：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1. 当只有两个case或者case的value取值是一段连续的数字的时候，我们可以选择if-else语句;</div><div class="line">2. 当有3~10个case数并且case的value取值非线性的时候，我们可以选择switch-case语句;</div><div class="line">3. 当case数达到10个以上并且每次的结果只是一个取值而不是额外的JavaScript语句的时候，我们可以选择查找表.</div></pre></td></tr></table></figure>
<h2 id="事件委托减少循环绑定的事件"><a href="#事件委托减少循环绑定的事件" class="headerlink" title="事件委托减少循环绑定的事件"></a>事件委托减少循环绑定的事件</h2><p><strong>什么是事件委托：通俗的讲，事件就是onclick，onmouseover，onmouseout，等就是事件，委托呢，就是让别人来做，这个事件本来是加在某些元素上的，然而你却加到别人身上来做，完成这个事件。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">也就是：利用冒泡的原理，把事件加到父级上，触发执行效果。</div><div class="line">好处呢：</div><div class="line">1.提高性能。</div><div class="line">2.新添加的元素还会有之前的事件。</div></pre></td></tr></table></figure>
<p>试想一下,一个页面上<strong>ul</strong>的每一个<strong>li</strong>标签添加一个事件，我们会不会给每一个标签都添加一个<strong>onclick</strong>呢。 当页面中存在大量元素都需要绑定同一个事件处理的时候，这种情况可能会影响性能,不仅消耗了内存,还多循环时间。每绑定一个事件都加重了页面或者是运行期间的负担。对于一个富前端的应用，交互重的页面上，过多的绑定会占用过多内存。 一个简单优雅的方式就是事件委托。它是基于事件的工作流：逐层捕获，到达目标，逐层冒泡。既然事件存在冒泡机制，那么我们可以通过给外层绑定事件，来处理所有的子元素出发的事件。<br>一个事件委托的简单实现:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">'ulId'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> e = e || <span class="built_in">window</span>.event;</div><div class="line">    <span class="keyword">var</span> target = e.target || e.srcElement; <span class="comment">//兼容旧版本IE和现代浏览器</span></div><div class="line">    <span class="keyword">if</span> (target.nodeName.toLowerCase() !== <span class="string">'ul'</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(target.innerHTML);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们可以看一个例子：需要触发每个li来改变他们的背景颜色。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;ul id=&quot;ul&quot;&gt;</div><div class="line">  &lt;li&gt;1&lt;/li&gt;</div><div class="line">  &lt;li&gt;2&lt;/li&gt;</div><div class="line">  &lt;li&gt;3&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure>
<p>首先想到最直接的实现:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> oUl = <span class="built_in">document</span>.querySelector(<span class="string">"#ul"</span>);</div><div class="line">    <span class="keyword">let</span> aLi = oUl.querySelectorAll(<span class="string">"li"</span>);</div><div class="line">    <span class="built_in">Array</span>.from(aLi).forEach(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</div><div class="line">        ele.onmouseover = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">this</span>.style.background = <span class="string">"red"</span>;</div><div class="line">        &#125;</div><div class="line">        ele.onmouseout = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">this</span>.style.background = <span class="string">""</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样我们就可以做到li上面添加鼠标事件。</p>
<p>但是如果说我们可能有很多个li用for循环的话就比较影响性能。</p>
<p>下面我们可以用事件委托的方式来实现这样的效果。html不变</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> oUl = <span class="built_in">document</span>.querySelector(<span class="string">"#ul"</span>);</div><div class="line">    <span class="comment">/*</span></div><div class="line">    这里要用到事件源：event 对象，事件源，不管在哪个事件中，只要你操作的那个元素就是事件源。</div><div class="line">    ie：window.event.srcElement</div><div class="line">    标准下:event.target</div><div class="line">    nodeName:找到元素的标签名</div><div class="line">    */</div><div class="line">    <span class="comment">//虽然习惯用ES6语法写代码,这里事件还是兼容一下IE吧</span></div><div class="line">    oUl.onmouseover = <span class="function"><span class="params">ev</span> =&gt;</span> &#123;</div><div class="line">        ev = ev || <span class="built_in">window</span>.event;</div><div class="line">        <span class="keyword">let</span> target = ev.target || ev.srcElement;</div><div class="line">        <span class="comment">//console.log(target.innerHTML);</span></div><div class="line">        <span class="keyword">if</span> (target.nodeName.toLowerCase() === <span class="string">"li"</span>) &#123;</div><div class="line">            target.style.background = <span class="string">"red"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    oUl.onmouseout = <span class="function"><span class="params">ev</span>=&gt;</span> &#123;</div><div class="line">        ev = ev || <span class="built_in">window</span>.event;</div><div class="line">        <span class="keyword">let</span> target = ev.target || ev.srcElement;</div><div class="line">        <span class="comment">//console.log(target.innerHTML);</span></div><div class="line">        <span class="keyword">if</span> (target.nodeName.toLowerCase() == <span class="string">"li"</span>) &#123;</div><div class="line">            target.style.background = <span class="string">""</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>好处2，新添加的元素还会有之前的事件。</p>
<p>我们还拿这个例子看，但是我们要做动态的添加li。点击button动态添加li</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"btn"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"ul"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<p>不用事件委托我们会这样做：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> oUl = <span class="built_in">document</span>.querySelector(<span class="string">"#ul"</span>);</div><div class="line">    <span class="keyword">let</span> aLi = oUl.querySelectorAll(<span class="string">"li"</span>);</div><div class="line">    <span class="keyword">let</span> oBtn = <span class="built_in">document</span>.querySelector(<span class="string">"#btn"</span>);</div><div class="line">    <span class="keyword">let</span> iNow = <span class="number">4</span>;</div><div class="line">    <span class="comment">//刚才用forEach实现,现在就用性能最高的for实现,把刚才学的温习一下</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = aLi.length; i &lt; len; i++) &#123;</div><div class="line">        aLi[i].onmouseover = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">this</span>.style.background = <span class="string">"red"</span>;</div><div class="line">        &#125;</div><div class="line">        aLi[i].onmouseout = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">this</span>.style.background = <span class="string">""</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    oBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        iNow++;</div><div class="line">        <span class="keyword">let</span> oLi = <span class="built_in">document</span>.createElement(<span class="string">"li"</span>);</div><div class="line">        oLi.innerHTML = <span class="number">1</span>* iNow;</div><div class="line">        oUl.appendChild(oLi);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样做我们可以看到点击按钮新加的li上面没有鼠标移入事件来改变他们的背景颜色。</p>
<p>因为点击添加的时候for循环已经执行完毕。</p>
<p>那么我们用事件委托的方式来做。就是html不变</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> oUl = <span class="built_in">document</span>.querySelector(<span class="string">"#ul"</span>);</div><div class="line">    <span class="keyword">let</span> oBtn = <span class="built_in">document</span>.querySelector(<span class="string">"#btn"</span>);</div><div class="line">    <span class="keyword">let</span> iNow = <span class="number">4</span>;</div><div class="line">    oUl.onmouseover = <span class="function"><span class="params">ev</span> =&gt;</span> &#123;</div><div class="line">        ev = ev || <span class="built_in">window</span>.event;</div><div class="line">        <span class="keyword">let</span> target = ev.target || ev.srcElement;</div><div class="line">        <span class="keyword">if</span> (target.nodeName.toLowerCase() === <span class="string">"li"</span>) &#123;</div><div class="line">            target.style.background = <span class="string">"red"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    oUl.onmouseout = <span class="function"><span class="params">ev</span> =&gt;</span> &#123;</div><div class="line">        ev = ev || <span class="built_in">window</span>.event;</div><div class="line">        <span class="keyword">let</span> target = ev.target || ev.srcElement;</div><div class="line">        <span class="keyword">if</span> (target.nodeName.toLowerCase() == <span class="string">"li"</span>) &#123;</div><div class="line">            target.style.background = <span class="string">""</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    oBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        iNow++;</div><div class="line">        <span class="keyword">let</span> oLi = <span class="built_in">document</span>.createElement(<span class="string">"li"</span>);</div><div class="line">        oLi.innerHTML = <span class="number">1111</span> * iNow;</div><div class="line">        oUl.appendChild(oLi);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="更快速的数据访问"><a href="#更快速的数据访问" class="headerlink" title="更快速的数据访问"></a>更快速的数据访问</h2><p>对于浏览器来说，一个标识符所处的位置越深，去读写他的速度也就越慢(对于这点，原型链亦是如此)。这个应该不难理解，简单比喻就是：杂货店离你家越远，你去打酱油所花的时间就越长… 熊孩子，打个酱油那么久，菜早烧焦了 -.-~</p>
<p>我们在编码过程中多多少少会使用到一些全局变量（window,document,自定义全局变量等等），了解javascript作用域链的人都知道，在局部作用域中访问全局变量需要一层一层遍历整个作用域链直至顶级作用域，而局部变量的访问效率则会更快更高，因此在局部作用域中高频率使用一些全局对象时可以将其导入到局部作用域中，例如:<br>对比看看:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//修改前</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showLi</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(;i&lt;<span class="built_in">document</span>.getElementsByTagName(<span class="string">"li"</span>).length;i++)&#123;  <span class="comment">//一次访问document</span></div><div class="line">    <span class="built_in">console</span>.log(i,<span class="built_in">document</span>.getElementsByTagName(<span class="string">"li"</span>)[i]); <span class="comment">//三次访问document</span></div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//修改后</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showLi</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> li_s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"li"</span>); <span class="comment">//一次访问document</span></div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(;i&lt;li_s.length;i++)&#123;</div><div class="line">    <span class="built_in">console</span>.log(i,li_s[i]); <span class="comment">//三次访问局部变量li_s</span></div><div class="line">  &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>再来看看两个简单的例子;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1、作为参数传入模块  </span></div><div class="line"> (<span class="function"><span class="keyword">function</span>(<span class="params">window,$</span>)</span>&#123;  </div><div class="line">     <span class="keyword">var</span> xxx = <span class="built_in">window</span>.xxx;  </div><div class="line">     $(<span class="string">"#xxx1"</span>).xxx();  </div><div class="line">     $(<span class="string">"#xxx2"</span>).xxx();  </div><div class="line"> &#125;)(<span class="built_in">window</span>,jQuery);  </div><div class="line">   </div><div class="line"> <span class="comment">//2、暂存到局部变量  </span></div><div class="line"> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </div><div class="line">    <span class="keyword">var</span> doc = <span class="built_in">document</span>;  </div><div class="line">    <span class="keyword">var</span> global = <span class="built_in">window</span>.global;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="eval以及类eval问题"><a href="#eval以及类eval问题" class="headerlink" title="eval以及类eval问题"></a>eval以及类eval问题</h2><p>我们都知道eval可以将一段字符串当做js代码来执行处理，据说使用eval执行的代码比不使用eval的代码慢100倍以上（具体效率我没有测试，有兴趣同学可以测试一下）,前面的浏览器控制台效率低下也提到eval这个问题.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">JavaScript 代码在执行前会进行类似“预编译”的操作：首先会创建一个当前执行环境下的活动对象，并将那些用 var </div><div class="line">申明的变量设置为活动对象的属性，但是此时这些变量的赋值都是 undefined，并将那些以 function 定义的函数也</div><div class="line">添加为活动对象的属性，而且它们的值正是函数的定义。但是，如果你使用了“eval”，则“eval”中的代码（实际上为字</div><div class="line">符串）无法预先识别其上下文，无法被提前解析和优化，即无法进行预编译的操作。所以，其性能也会大幅度降低</div></pre></td></tr></table></figure>
<p>对上面js的<strong>预编译</strong>,<strong>活动对象</strong>等一些列不太明白的童鞋.看完这篇文章恶补一下,我想你会收获很多:<a href="http://www.jianshu.com/p/330b1505e41d" target="_blank" rel="external">前端基础进阶（三）：变量对象详解</a></p>
<p>其实现在大家一般都很少会用eval了，这里我想说的是两个类eval的场景(new Function{},setTimeout,<br>setInterver)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">setTimtout(<span class="string">"alert(1)"</span>,<span class="number">1000</span>);  </div><div class="line"> </div><div class="line">setInterver(<span class="string">"alert(1)"</span>,<span class="number">1000</span>);  </div><div class="line"> </div><div class="line">(<span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"alert(1)"</span>))();</div></pre></td></tr></table></figure>
<p>上述几种类型代码执行效率都会比较低，因此建议直接传入匿名方法、或者方法的引用给setTimeout方法.</p>
<h2 id="DOM操作的优化"><a href="#DOM操作的优化" class="headerlink" title="DOM操作的优化"></a>DOM操作的优化</h2><p>众所周知的，DOM操作远比javascript的执行耗性能，虽然我们避免不了对DOM进行操作，但我们可以尽量去减少该操作对性能的消耗。</p>
<p>为什么操作DOM这么耗费性能呢?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">浏览器通常会把js和DOM分开来分别独立实现。 </div><div class="line">举个栗子冷知识，在IE中，js的实现名为JScript，位于jscript.dll文件中；DOM的实现则存在另一个库中，名为mshtml.dll（Trident）。</div><div class="line">Chrome中的DOM实现为webkit中的webCore，但js引擎是Google自己研发的V8。 </div><div class="line">Firefox中的js引擎是SpiderMonkey，渲染引擎（DOM）则是Gecko。</div></pre></td></tr></table></figure>
<p><strong>DOM，天生就慢</strong></p>
<p>前面的小知识中说过，浏览器把实现页面渲染的部分和解析js的部分分开来实现，既然是分开的，一旦两者需要产生连接，就要付出代价。 </p>
<p>两个例子：</p>
<blockquote>
<ol>
<li>小明和小红是两个不同学校的学生，两个人家里经济条件都不太好，买不起手机（好尴尬的设定Orz…），所以只能通过写信来互相交流，这样的过程肯定比他俩面对面交谈时所需要花费的代价大（额外的事件、写信的成本等）。</li>
<li>官方例子：把DOM和js（ECMAScript）各自想象为一座岛屿，它们之间用收费桥进行连接。ECMAScript每次访问DOM，都要途径这座桥，并交纳“过桥费”。访问DOM的次数越多，费用也就越高。</li>
</ol>
</blockquote>
<p>因此，推荐的做法是：<strong>尽可能的减少过桥的次数，努力待在ECMAScript岛上。</strong></p>
<p>让我们通过一个最简单的代码解释这个问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">innerLi_s</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">   <span class="keyword">for</span>(;i&lt;<span class="number">20</span>;i++)&#123;</div><div class="line">     <span class="built_in">document</span>.getElementById(<span class="string">"Num"</span>).innerHTML=<span class="string">"A"</span>; </div><div class="line">     <span class="comment">//进行了20次循环，每次又有2次DOM元素访问：一次读取innerHTML的值，一次写入值</span></div><div class="line">   &#125;;</div><div class="line"> &#125;;</div></pre></td></tr></table></figure>
<p>针对以上方法进行一次改写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">innerLi_s</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="keyword">var</span> content =<span class="string">""</span>;</div><div class="line">   <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">   <span class="keyword">for</span>(;i&lt;<span class="number">20</span>;i++)&#123;</div><div class="line">     content += <span class="string">"A"</span>; <span class="comment">//这里只对js的变量循环了20次</span></div><div class="line">   &#125;;</div><div class="line">   <span class="built_in">document</span>.getElementById(<span class="string">"Num"</span>).innerHTML += content; </div><div class="line">   <span class="comment">//这里值进行了一次DOM操作，又分2次DOM访问：一次读取innerHTML的值，一次写入值</span></div><div class="line"> &#125;;</div></pre></td></tr></table></figure>
<h2 id="减少页面的重排-Reflows-和重绘-Repaints"><a href="#减少页面的重排-Reflows-和重绘-Repaints" class="headerlink" title="减少页面的重排(Reflows)和重绘(Repaints)"></a>减少页面的重排(Reflows)和重绘(Repaints)</h2><p>简单说下什么是重排和重绘:<br><strong>浏览器下载完HTMl，CSS，JS后会生成两棵树：DOM树和渲染树。 当Dom的几何属性发生变化时，比如Dom的宽高，或者颜色，position，浏览器需要重新计算元素的几何属性，并且重新构建渲染树，这个过程称之为重绘重排。</strong></p>
<p>元素布局的改变或内容的增删改或者浏览器窗口尺寸改变都将会导致重排，而字体颜色或者背景色的修改则将导致重绘。<br>对于类似以下代码的操作，据说现代浏览器大多进行了优化(将其优化成1次重排版)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//修改前</span></div><div class="line"> <span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>);</div><div class="line"> el.style.borderLeft = <span class="string">"1px"</span>; <span class="comment">//1次重排版</span></div><div class="line"> el.style.borderRight = <span class="string">"2px"</span>; <span class="comment">//又1次重排版</span></div><div class="line"> el.style.padding = <span class="string">"5px"</span>; <span class="comment">//还有1次重排版</span></div><div class="line"> <span class="comment">//修改后</span></div><div class="line"> <span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>);</div><div class="line"> el.style.cssText = <span class="string">"border-left:1px;border-right:2px;padding:5px"</span>; <span class="comment">//1次重排版</span></div></pre></td></tr></table></figure>
<p>针对多重操作，以下三种方法也可以减少重排版和重绘的次数：</p>
<ol>
<li>Dom先隐藏，操作后再显示 2次重排 (临时的display:none);</li>
<li>document.createDocumentFragment() 创建文档片段处理，操作后追加到页面 1次重排;</li>
<li>var newDOM = oldDOM.cloneNode(true)创建Dom副本，修改副本后oldDOM.parentNode.replaceChild<br>(newDOM,oldDOM)覆盖原DOM 2次重排</li>
<li>如果是动画元素的话，最好使用绝对定位以让它不在文档流中，这样的话改变它的位置不会引起页面其它元素重排 </li>
</ol>
<p>更多DOM优化的细节以及关于浏览器页面的<strong>重排(Reflows)和重绘(Repaints)</strong>的概念和优化请参考:<a href="https://segmentfault.com/a/1190000008267184" target="_blank" rel="external">天生就慢的DOM如何优化？</a>,花10+分钟阅读,你会受益匪浅.</p>
<h2 id="尽量少去改变作用域链"><a href="#尽量少去改变作用域链" class="headerlink" title="尽量少去改变作用域链"></a>尽量少去改变作用域链</h2><ul>
<li><strong>使用with</strong></li>
<li><strong>try catch</strong></li>
</ul>
<p>我了解到的JavaScript中改变作用域链的方式只有两种1）使用with表达式 2）通过捕获异常try catch来实现</p>
<p>但是with是大家都深恶痛绝的影响性能的表达式，因为我们完全可以通过使用一个局部变量的方式来取代它（因为with的原理是它的改变作用域链的同时需要保存很多信息以保证完成当前操作后恢复之前的作用域链，这些就明显的影响到了性能）</p>
<p>try catch中的catch子句同样可以改变作用域链。当try块发生错误时，程序自动转入catch块并将异常对象推入作用域链前端的一个可变对象中，也就是说在catch块中，函数所有的局部变量已经被放在第二个作用域链对象中，但是catch子句执行完成之后，作用域链就会返回到原来的状态。应该最小化catch子句来保证代码性能，如果知道错误的概念很高，我们应该尽量修正错误而不是使用try catch.</p>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p><strong>虽说现代浏览器都已经做的很好了，但是本兽觉得这是自己对代码质量的一个追求。并且可能一个点或者两个点不注意是不会产生多大性能影响，但是从多个点进行优化后，可能产生的就会质的飞跃了</strong><br><strong>JavaScript 总结的这几个提高性能知识点，希望大家牢牢掌握。</strong></p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章:"></a>参考文章:</h2><blockquote>
<p><a href="http://www.cnblogs.com/zichi/p/4668420.html" target="_blank" rel="external">高性能JavaScript循环语句和流程控制</a><br><a href="http://blog.csdn.net/spy19881201/article/details/5851792" target="_blank" rel="external">if else 和 switch的效率</a><br><a href="http://www.2cto.com/os/201404/291376.html" target="_blank" rel="external">switch…case和if…else效率比较</a><br><a href="http://www.jb51.net/article/78093.htm" target="_blank" rel="external">JavaScript提高性能知识点汇总</a><br><a href="http://developer.51cto.com/art/201304/387486.htm" target="_blank" rel="external">JavaScript执行效率小结</a><br><a href="https://segmentfault.com/a/1190000008267184" target="_blank" rel="external">天生就慢的DOM如何优化？</a><br><a href="http://developer.51cto.com/art/201212/372463.htm" target="_blank" rel="external">编写高性能的JavaScript代码</a></p>
</blockquote>
<p><strong>我的<a href="https://github.com/jawil/blog" target="_blank" rel="external">github博客</a>,喜欢的朋友可以点个star,你的支持就是我学习、搬运、总结和拓展的动力.</strong></p>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang" title="打赏，支持一下">赏</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()" title="关闭">×</a>
            <div class="shang_tit">
              <p>纯属好玩</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
            </div>
              <div class="pay_explain">扫码打赏，你说多少就多少，买房就差你们打赏之外那部分钱</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="支付宝" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="微信" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"支付宝":"微信");
          });
          function dashangToggle(){
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/">吹毛求疵的追求优雅高性能JavaScript</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 前端小密圈 的个人博客">前端小密圈</a></p>
        <p><span>发布时间:</span>2017年02月24日 - 13时09分</p>
        <p><span>最后更新:</span>2017年04月30日 - 16时49分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/" title="吹毛求疵的追求优雅高性能JavaScript">http://qdxmq.com/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/</a>
            <span class="copy-path" data-clipboard-text="原文: http://qdxmq.com/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/　　作者: 前端小密圈" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2017/02/26/一道JS面试题所引发的血案，透过现象寻本质，再从本质看现象/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          一道JS面试题所引发的血案，透过现象寻本质，再从本质看现象
        
      </div>
    </a>
  
  
    <a href="/2017/02/22/从-为-true-来剖析-JavaScript-各种蛋疼的类型转换/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">从 []==为 true 来剖析 JavaScript 各种蛋疼的类型转换</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#本文已经首发在掘金专栏-谢谢各位的收藏与支持-掘金专栏地址"><span class="toc-number">1.</span> <span class="toc-text">本文已经首发在掘金专栏,谢谢各位的收藏与支持,掘金专栏地址~~~</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#算法和流程控制的优化"><span class="toc-number">2.</span> <span class="toc-text">算法和流程控制的优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#循坏"><span class="toc-number">2.0.1.</span> <span class="toc-text">循坏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#条件语句"><span class="toc-number">2.0.2.</span> <span class="toc-text">条件语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事件委托减少循环绑定的事件"><span class="toc-number">3.</span> <span class="toc-text">事件委托减少循环绑定的事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更快速的数据访问"><span class="toc-number">4.</span> <span class="toc-text">更快速的数据访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eval以及类eval问题"><span class="toc-number">5.</span> <span class="toc-text">eval以及类eval问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM操作的优化"><span class="toc-number">6.</span> <span class="toc-text">DOM操作的优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#减少页面的重排-Reflows-和重绘-Repaints"><span class="toc-number">7.</span> <span class="toc-text">减少页面的重排(Reflows)和重绘(Repaints)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#尽量少去改变作用域链"><span class="toc-number">8.</span> <span class="toc-text">尽量少去改变作用域链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">9.</span> <span class="toc-text">最后</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文章"><span class="toc-number">10.</span> <span class="toc-text">参考文章:</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
<script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
<script>
var cloudTieConfig = {
  url: document.location.href,
  sourceId: "",
  productKey: "f4eaa09d046240cfacb415bc5435e021",
  target: "cloud-tie-wrapper"
};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);
</script>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/02/26/一道JS面试题所引发的血案，透过现象寻本质，再从本质看现象/" title="上一篇: 一道JS面试题所引发的血案，透过现象寻本质，再从本质看现象">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2017/02/22/从-为-true-来剖析-JavaScript-各种蛋疼的类型转换/" title="下一篇: 从 []==为 true 来剖析 JavaScript 各种蛋疼的类型转换">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/02/一道面试题：不用call和apply方法用原生JavaScript模拟实现ES5的bind方法/">不用call和apply方法模拟实现ES5的bind方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/奇文共欣赏，疑义相与析/">奇文共欣赏，疑义相与析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/通俗大白话来理解TCP协议的三次握手和四次分手/">通俗大白话来理解TCP协议的三次握手和四次分手</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/20/从探究Function-proto-Function-prototype过程中的一些收获/"> 从探究Function.__proto__===Function.prototype过程中的一些收获</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/12/神器！解放你的双手——UI设计稿全自动切图和标注的工具推荐/">神器！解放你的双手——UI设计稿全自动切图和标注的工具推荐</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/09/工作中经常用到github上优秀、实用、轻量级、无依赖的插件和库/">工作中经常用到github上优秀、实用、轻量级、无依赖的插件和库</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/05/深入浅出DOM基础——《DOM探索之基础详解篇》学习笔记/"> 深入浅出DOM基础——《DOM探索之基础详解篇》学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/01/纯CSS实现网站常用的五角星评分和分数展示交互效果/">纯CSS实现网站常用的五角星评分和分数展示交互效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/16/关于Node进程管理器PM2使用技巧和需要注意的地方/">关于Node进程管理器PM2使用技巧和需要注意的地方</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/05/从-10-深入浅出弱类型JS的隐式转换 17-04-47-592/">从++[[]][+[]]+[+[]]==10?深入浅出弱类型JS的隐式转换</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/01/来自掘金的你——挖-掘-淘-金-之-前端闯关历险记学习资料汇总/">来自掘金的你——挖 掘 淘 金 之 前端闯关历险记学习资料汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/一道JS面试题所引发的血案，透过现象寻本质，再从本质看现象/">一道JS面试题所引发的血案，透过现象寻本质，再从本质看现象</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/24/吹毛求疵的追求优雅高性能JavaScript/">吹毛求疵的追求优雅高性能JavaScript</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/22/从-为-true-来剖析-JavaScript-各种蛋疼的类型转换/">从 []==为 true 来剖析 JavaScript 各种蛋疼的类型转换</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 💕 前端小密圈
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/jawil/" target="_blank">hexo-theme-xmq</a> by jawil modify
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本日小蜜蜂🐝:
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量:
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>
